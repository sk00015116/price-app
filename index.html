<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¾¡æ ¼ä¸€è¦§</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #0f172a;
  color: white;
  margin: 0;
  padding: 20px;
}
h1 { text-align: center; margin-bottom: 20px; }

.card {
  background: #1e293b;
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 14px;
}

.row {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.price {
  font-size: 18px;
  font-weight: bold;
}

svg {
  width: 100%;
  height: 40px;
  margin-top: 8px;
}

.line {
  fill: none;
  stroke-width: 2;
}

.up { stroke: #22c55e; color:#22c55e; }
.down { stroke: #ef4444; color:#ef4444; }

.time {
  text-align: center;
  font-size: 12px;
  color: #94a3b8;
  margin-top: 20px;
}
</style>
</head>
<body>

<h1>ğŸ“ˆ ä¾¡æ ¼ä¸€è¦§</h1>

<div class="card">
  <div class="row"><span>BTC</span><span id="btc" class="price">å–å¾—ä¸­</span></div>
  <svg><polyline id="btc-line" class="line"/></svg>
</div>

<div class="card">
  <div class="row"><span>ETH</span><span id="eth" class="price">å–å¾—ä¸­</span></div>
  <svg><polyline id="eth-line" class="line"/></svg>
</div>

<div class="card">
  <div class="row"><span>XRP</span><span id="xrp" class="price">å–å¾—ä¸­</span></div>
  <svg><polyline id="xrp-line" class="line"/></svg>
</div>

<div class="card">
  <div class="row"><span>SOL</span><span id="sol" class="price">å–å¾—ä¸­</span></div>
  <svg><polyline id="sol-line" class="line"/></svg>
</div>

<div class="time" id="time"></div>

<script>
const history = {
  btc: [], eth: [], xrp: [], sol: []
};

function drawLine(id, values) {
  const max = Math.max(...values);
  const min = Math.min(...values);
  const h = 40, w = 300;
  const points = values.map((v,i)=>{
    const x = (i/(values.length-1||1))*w;
    const y = h - ((v-min)/(max-min||1))*h;
    return `${x},${y}`;
  }).join(" ");

  document.getElementById(id+"-line")
    .setAttribute("points", points);
}

function update(id, price) {
  const arr = history[id];
  arr.push(price);
  if (arr.length > 30) arr.shift();

  const p = document.getElementById(id);
  p.textContent = price.toLocaleString()+" å††";

  const line = document.getElementById(id+"-line");
  if (arr.length >= 2) {
    line.classList.remove("up","down");
    line.classList.add(arr[arr.length-1] >= arr[0] ? "up":"down");
    drawLine(id, arr);
  }
}

async function fetchPrices() {
  const r = await fetch(
    "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,ripple,solana&vs_currencies=jpy"
  );
  const d = await r.json();

  update("btc", d.bitcoin.jpy);
  update("eth", d.ethereum.jpy);
  update("xrp", d.ripple.jpy);
  update("sol", d.solana.jpy);

  document.getElementById("time").textContent =
    "æœ€çµ‚æ›´æ–° " + new Date().toLocaleTimeString();
}

fetchPrices();
setInterval(fetchPrices, 10000);
</script>

</body>
</html>